---
import { getCollection } from "astro:content";
import HtmlLayout from "../../layouts/HtmlLayout.astro";
import "../../styles/transitions.css";

const recipes = (await getCollection("recipes")).filter(
  (post) => post.data.published !== false || process.env.NODE_ENV === "development",
);

// .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<HtmlLayout title="Recipes">
  <main id="content" class="mx-auto w-full max-w-5xl px-5 py-8">
    <header class="px-4">
      <h1 class="text-5xl font-bold">Recipes on <a href="/">Bits and Pieces</a></h1>
      <p class="text-xl mt-1">Derk-Jan's favourite recipes</p>
    </header>

    <ol class="mt-12 space-y-6" role="list">
      {
        recipes.map((recipe) => (
          <li>
            <article class="transition p-4 focus-within:ring-2 focus-within:ring-pink-500 dark:focus-within:ring-yellow-500 max-w-2xl rounded-md">
              <header>
                <h2>
                  <a
                    href={`/recipes/${recipe.id}`}
                    class="text-3xl font-semibold no-underline focus:outline-none"
                    aria-describedby={`${recipe.id}-description`}
                    data-astro-prefetch
                  >
                    {/*transition:animate="slide"
                      transition:name={md5(article.id)}
                      */}
                    <span>
                      {recipe.data.published === false ? "(Draft) " : ""}
                      {recipe.data.title}
                    </span>
                  </a>
                </h2>
                <span class="text-zinc-600 dark:text-zinc-400">
                  {recipe.data.vegan
                    ? "vegan"
                    : recipe.data.vegetarian
                      ? "vegetarian"
                      : recipe.data.pescetarian
                        ? "pescetarian"
                        : "omnivore"}
                </span>
              </header>
              <p id={`${recipe.id}-description`} class="mt-2 text-xl">
                {recipe.data.description}
              </p>
            </article>
          </li>
        ))
      }
    </ol>
  </main>
</HtmlLayout>
