<section data-component="PreviewDisplayTemplated" class="preview">
  <template data-template="digit">
    <div class="digit">
      <div class="∅"></div><div class="∅"></div><div class="∅"></div><div class="∅"></div>
      <div class="∅"></div><div class="∅"></div><div class="∅"></div><div class="∅"></div>
      <div class="∅"></div><div class="∅"></div><div class="∅"></div><div class="∅"></div>
      <div class="∅"></div><div class="∅"></div><div class="∅"></div><div class="∅"></div>
      <div class="∅"></div><div class="∅"></div><div class="∅"></div><div class="∅"></div>
      <div class="∅"></div><div class="∅"></div><div class="∅"></div><div class="∅"></div>
    </div>
  </template>

  <div class="display" data-target="display"></div>
</section>

<style>
  .preview {
    outline: 1px dotted light-dark(var(--color-zinc-800), var(--color-zinc-200));
    background-color: light-dark(var(--color-white), var(--color-zinc-950));

    max-width: 50rem;
    margin-left: auto;
    margin-right: auto;

    padding: 1rem;
    padding: clamp(2px, 1.5vw, 1rem);

    & > .display {
      display: flex;
      flex-direction: row;

      gap: 1rem;
      gap: clamp(2px, 1.5vw, 1rem);

      width: 100%;

      & > .digit {
        flex: 1 1 0;

        display: grid;
        grid-template-columns: repeat(4, 1fr);
        grid-template-rows: repeat(6, 1fr);

        gap: 0.5rem;
        gap: clamp(1px, 1vw, 0.5rem);
      }

      & > :nth-child(3) {
        margin-left: 2rem;
        margin-left: clamp(4px, 2.5vw, 2rem);
      }

      & > :nth-child(4) {
        margin-right: 2rem;
        margin-right: clamp(4px, 2.5vw, 2rem);
      }
    }
  }
</style>

<script>
  const component = document.querySelector('[data-component="PreviewDisplayTemplated"]');
  if (!component) {
    throw new Error("Expected [data-component] PreviewDisplayTemplated");
  }

  const template = component.querySelector<HTMLTemplateElement>(
    'template[data-template="digit"]',
  );
  const target = component.querySelector<HTMLElement>('[data-target="display"]');

  if (!template || !target) {
    throw new Error(
      'Expected [data-component] PreviewDisplayTemplated with [data-template="digit"] and [data-target="display"]',
    );
  }

  function write(style: CSSStyleDeclaration, property: string, angle: number) {
    style.setProperty(property, `${angle}deg`);
  }

  function randomAngle(): number {
    return Math.floor(Math.random() * 360);
  }

  for (let i = 0; i < 6; i++) {
    const clone = template.content.cloneNode(true) as HTMLElement;

    for (const tinyClock of clone.firstElementChild?.children || []) {
      if (tinyClock instanceof HTMLElement) {
        write(tinyClock.style, "--angle-hour", randomAngle());
        write(tinyClock.style, "--angle-minute", randomAngle());
      }
    }

    target.appendChild(clone);
  }
</script>
